{{/* views/subscriptions.html */}}
<div class="container mt-4">
  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∫–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>üé´ {{.Title}}</h1>
    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addSubscriptionModal">
      ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç
    </button>
  </div>

  {{if .Message}}
  <div class="alert alert-info">
    <h5>{{.Message}}</h5>
    <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π –∞–±–æ–Ω–µ–º–µ–Ω—Ç.</p>
  </div>
  {{end}}

  <!-- –¢–∞–±–ª–∏—Ü–∞ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤ -->
  <div class="card">
    <div class="card-header">
      <h5 class="card-title mb-0">–°–ø–∏—Å–æ–∫ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤</h5>
    </div>
    <div class="card-body">
      {{if .Subscriptions}}
      <div class="table-responsive">
        <table class="table table-striped table-hover align-middle">
          <thead class="table-dark">
            <tr>
              <th>ID</th>
              <th>–ö–ª–∏–µ–Ω—Ç</th>
              <th>–¢–∞—Ä–∏—Ñ</th>
              <th>–ù–∞—á–∞–ª–æ</th>
              <th>–û–∫–æ–Ω—á–∞–Ω–∏–µ</th>
              <th>–°—Ç–∞—Ç—É—Å</th>
              <th>–¶–µ–Ω–∞</th>
              <th style="width:120px;">–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody>
            {{range .Subscriptions}}
            <tr>
              <td>{{.ID}}</td>
              <td>{{.ClientName}}</td>
              <td>{{.TariffName}}</td>
              <td>{{.StartDate.Format "2006-01-02"}}</td>
              <td>{{.EndDate.Format "2006-01-02"}}</td>
              <td>
                <span class="badge {{if eq .Status "–ê–∫—Ç–∏–≤–µ–Ω"}}bg-success{{else if eq .Status "–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"}}bg-warning{{else}}bg-secondary{{end}}">
                  {{.Status}}
                </span>
              </td>
              <td>{{printf "%.2f" .Price}} ‚ÇΩ</td>
              <td>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-outline-primary edit-sub-btn"
                          title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
                          data-sub-id="{{.ID}}">
                    ‚úèÔ∏è
                  </button>
                  <button class="btn btn-outline-danger delete-sub-btn"
                          title="–£–¥–∞–ª–∏—Ç—å"
                          data-sub-id="{{.ID}}"
                          data-client-name="{{.ClientName}}">
                    üóëÔ∏è
                  </button>
                </div>
              </td>
            </tr>
            {{end}}
          </tbody>
        </table>
      </div>
      {{else}}
      <div class="alert alert-info">
        <h5>–ê–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h5>
        <p>–ù–∞–∂–º–∏—Ç–µ ¬´–î–æ–±–∞–≤–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç¬ª, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π.</p>
      </div>
      {{end}}
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞: –¥–æ–±–∞–≤–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç -->
<div class="modal fade" id="addSubscriptionModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg"><div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç</h5>
      <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
    </div>
    <form id="addSubscriptionForm">
      <div class="modal-body">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">–ö–ª–∏–µ–Ω—Ç *</label>
            <select class="form-select" name="client_id" id="clientSelect" required>
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞...</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">–¢–∞—Ä–∏—Ñ *</label>
            <select class="form-select" name="tariff_id" id="tariffSelect" required>
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ...</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ *</label>
            <input type="date" class="form-control" name="start_date" required>
          </div>
          <div class="col-md-6">
            <label class="form-label">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è *</label>
            <input type="date" class="form-control" name="end_date" required>
          </div>
          <div class="col-md-6">
            <label class="form-label">–°—Ç–∞—Ç—É—Å *</label>
            <select class="form-select" name="status" required>
              <option value="–ê–∫—Ç–∏–≤–µ–Ω" selected>–ê–∫—Ç–∏–≤–µ–Ω</option>
              <option value="–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω">–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</option>
              <option value="–ó–∞–≤–µ—Ä—à–µ–Ω">–ó–∞–≤–µ—Ä—à–µ–Ω</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">–¶–µ–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
            <input type="number" step="0.01" min="0" class="form-control" name="price" placeholder="–ï—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî –≤–æ–∑—å–º—ë–º –∏–∑ —Ç–∞—Ä–∏—Ñ–∞">
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" type="button" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-primary" type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </form>
  </div></div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞: —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç -->
<div class="modal fade" id="editSubscriptionModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg"><div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç</h5>
      <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
    </div>
    <form id="editSubscriptionForm">
      <input type="hidden" name="id" id="editSubId">
      <div class="modal-body">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">–ö–ª–∏–µ–Ω—Ç *</label>
            <select class="form-select" name="client_id" id="editClientSelect" required></select>
          </div>
          <div class="col-md-6">
            <label class="form-label">–¢–∞—Ä–∏—Ñ *</label>
            <select class="form-select" name="tariff_id" id="editTariffSelect" required></select>
          </div>
          <div class="col-md-6">
            <label class="form-label">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ *</label>
            <input type="date" class="form-control" name="start_date" id="editStartDate" required>
          </div>
          <div class="col-md-6">
            <label class="form-label">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è *</label>
            <input type="date" class="form-control" name="end_date" id="editEndDate" required>
          </div>
          <div class="col-md-6">
            <label class="form-label">–°—Ç–∞—Ç—É—Å *</label>
            <select class="form-select" name="status" id="editStatus" required>
              <option value="–ê–∫—Ç–∏–≤–µ–Ω">–ê–∫—Ç–∏–≤–µ–Ω</option>
              <option value="–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω">–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</option>
              <option value="–ó–∞–≤–µ—Ä—à–µ–Ω">–ó–∞–≤–µ—Ä—à–µ–Ω</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">–¶–µ–Ω–∞</label>
            <input type="number" step="0.01" min="0" class="form-control" name="price" id="editPrice">
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" type="button" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-primary" type="submit">–û–±–Ω–æ–≤–∏—Ç—å</button>
      </div>
    </form>
  </div></div>
</div>
